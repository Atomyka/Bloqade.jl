<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lattices · EaRyd.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/EaRyd.jl/lattices/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">EaRyd.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../waveform/">Waveforms</a></li><li class="is-active"><a class="tocitem" href>Lattices</a><ul class="internal"><li><a class="tocitem" href="#Create-a-lattice"><span>Create a lattice</span></a></li><li><a class="tocitem" href="#Lattice-types"><span>Lattice types</span></a></li><li><a class="tocitem" href="#Generate-sites-and-sorting"><span>Generate sites and sorting</span></a></li><li><a class="tocitem" href="#Query-neighbors"><span>Query neighbors</span></a></li></ul></li><li><a class="tocitem" href="../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../emulation/">Emulation</a></li><li><a class="tocitem" href="../cuda/">CUDA Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/quantum-scar/">Quantum Scar</a></li><li><a class="tocitem" href="../tutorials/adiabatic/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../tutorials/qaoa/">Quantum Approximate Optimization Algorithm</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../topics/blockade/">Rydberg Blockade</a></li><li><a class="tocitem" href="../topics/bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../topics/ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../contrib/">Contributing EaRyd</a></li><li><a class="tocitem" href="../ref/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Lattices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lattices</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/EaRyd.jl/blob/master/docs/src/lattices.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Lattices"><a class="docs-heading-anchor" href="#Lattices">Lattices</a><a id="Lattices-1"></a><a class="docs-heading-anchor-permalink" href="#Lattices" title="Permalink"></a></h1><h2 id="Create-a-lattice"><a class="docs-heading-anchor" href="#Create-a-lattice">Create a lattice</a><a id="Create-a-lattice-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-lattice" title="Permalink"></a></h2><p>Creating a lattice is very simple in EaRyd, e.g we can create a square lattice as following</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using EaRyd</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; generate_sites(SquareLattice(), 3, 3)</code><code class="nohighlight hljs ansi" style="display:block;">9-element AtomList{2, Float64}:
 (0.0, 0.0)
 (1.0, 0.0)
 (2.0, 0.0)
 (0.0, 1.0)
 (1.0, 1.0)
 (2.0, 1.0)
 (0.0, 2.0)
 (1.0, 2.0)
 (2.0, 2.0)</code></pre><p>this generates the atom positions on a <span>$3\times 3$</span> square lattice using the <a href="../ref/#EaRydLattices.generate_sites-Union{Tuple{D}, Tuple{AbstractLattice{D}, Vararg{Int64, D}}} where D"><code>generate_sites</code></a> function.</p><p>we support the following built-in lattice: <a href="../ref/#EaRydLattices.SquareLattice"><code>SquareLattice</code></a>, <a href="../ref/#EaRydLattices.KagomeLattice"><code>KagomeLattice</code></a>, <a href="../ref/#EaRydLattices.HoneycombLattice"><code>HoneycombLattice</code></a>, and more. Please refer to <a href="#Lattices">Lattices</a> for more detailed guide of lattice related operation.</p><h2 id="Lattice-types"><a class="docs-heading-anchor" href="#Lattice-types">Lattice types</a><a id="Lattice-types-1"></a><a class="docs-heading-anchor-permalink" href="#Lattice-types" title="Permalink"></a></h2><p>A crystal lattice is completely determined by a set of Bravais lattice vectors (in unit of <span>$\mu m$</span>) plus atom locations in a unit cell. A <a href="https://en.wikipedia.org/wiki/Bravais_lattice">Bravais lattice</a> is an infinite array of decrete points generated by a set of discrete translation operations described by</p><p class="math-container">\[\mathbf{R} = n_1 \mathbf{a}_1 + n_2 \mathbf{a}_2 + \ldots + n_d a_d\]</p><p>where <span>$d$</span> is the dimension of space, <span>$n_1, \ldots, n_d \in Z$</span> are integers.</p><p>Hence the lattice vectors <span>$(\mathbf{a}_1, \mathbf{a}_2, \ldots, \mathbf{a}_n)$</span> defines a Bravais lattice. To create a simple lattice, we just place one atom at location <code>(0.0, 0.0)</code> in a unit cell. The following code defines a triangular lattice.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; triangular_manual = GeneralLattice([(1.0, 0.0), (0.5, 0.5*sqrt(3))], [(0.0, 0.0)])</code><code class="nohighlight hljs ansi" style="display:block;">GeneralLattice{2, 1, Float64}(((1.0, 0.0), (0.5, 0.8660254037844386)), ((0.0, 0.0),))</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You can see the above visulization in one of the following editors</p><ul><li>a <a href="https://github.com/julia-vscode/julia-vscode">VSCode</a> editor,</li><li>a <a href="https://github.com/JunoLab/Juno.jl">Jupyter</a> notebook,</li><li>or a <a href="https://github.com/fonsp/Pluto.jl">Pluto</a> notebook,</li></ul><p>But not in a Julia REPL that does not have a graphical display.</p></div></div><p>For composite lattices, one should provide multiple atoms as the second argument to specify atom locations in a unitcell. For example, the honeycomb lattice can be defined by typing</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; honeycomb_manual = GeneralLattice([(1.0, 0.0), (0.5, 0.5*sqrt(3))], [(0.0, 0.0), (0.5, 0.5/sqrt(3))])</code><code class="nohighlight hljs ansi" style="display:block;">GeneralLattice{2, 2, Float64}(((1.0, 0.0), (0.5, 0.8660254037844386)), ((0.0, 0.0), (0.5, 0.2886751345948129)))</code></pre><p>We provide a few shorthands for several useful lattices. One can use <a href="../ref/#EaRydLattices.lattice_vectors-Tuple{GeneralLattice}"><code>lattice_vectors</code></a> and <a href="../ref/#EaRydLattices.lattice_sites-Tuple{GeneralLattice}"><code>lattice_sites</code></a> to access the lattice vectors and atom locations in a unit cell as described in the above section.</p><h5 id="[ChainLattice](@ref)"><a class="docs-heading-anchor" href="#[ChainLattice](@ref)"><a href="../ref/#EaRydLattices.ChainLattice"><code>ChainLattice</code></a></a><a id="[ChainLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[ChainLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; chain = ChainLattice()</code><code class="nohighlight hljs ansi" style="display:block;">ChainLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(chain)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0,),)</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(chain)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0,),)</code></pre><h5 id="[SquareLattice](@ref)"><a class="docs-heading-anchor" href="#[SquareLattice](@ref)"><a href="../ref/#EaRydLattices.SquareLattice"><code>SquareLattice</code></a></a><a id="[SquareLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[SquareLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; square = SquareLattice()</code><code class="nohighlight hljs ansi" style="display:block;">SquareLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(square)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.0, 1.0))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(square)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0),)</code></pre><h5 id="[RectangularLattice](@ref)"><a class="docs-heading-anchor" href="#[RectangularLattice](@ref)"><a href="../ref/#EaRydLattices.RectangularLattice"><code>RectangularLattice</code></a></a><a id="[RectangularLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[RectangularLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; rectangle = RectangularLattice(0.5)</code><code class="nohighlight hljs ansi" style="display:block;">RectangularLattice(0.5)</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(rectangle)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.0, 0.5))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(rectangle)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0),)</code></pre><h5 id="[HoneycombLattice](@ref)"><a class="docs-heading-anchor" href="#[HoneycombLattice](@ref)"><a href="../ref/#EaRydLattices.HoneycombLattice"><code>HoneycombLattice</code></a></a><a id="[HoneycombLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[HoneycombLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; honeycomb = HoneycombLattice()</code><code class="nohighlight hljs ansi" style="display:block;">HoneycombLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(honeycomb)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.5, 0.8660254037844386))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(honeycomb)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0), (0.5, 0.2886751345948129))</code></pre><h5 id="[TriangularLattice](@ref)"><a class="docs-heading-anchor" href="#[TriangularLattice](@ref)"><a href="../ref/#EaRydLattices.TriangularLattice"><code>TriangularLattice</code></a></a><a id="[TriangularLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[TriangularLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; triangular = TriangularLattice()</code><code class="nohighlight hljs ansi" style="display:block;">TriangularLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(triangular)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.5, 0.8660254037844386))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(triangular)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0),)</code></pre><h5 id="[LiebLattice](@ref)"><a class="docs-heading-anchor" href="#[LiebLattice](@ref)"><a href="../ref/#EaRydLattices.LiebLattice"><code>LiebLattice</code></a></a><a id="[LiebLattice](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LiebLattice](@ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lieb = LiebLattice()</code><code class="nohighlight hljs ansi" style="display:block;">LiebLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(lieb)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.0, 1.0))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(lieb)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0), (0.5, 0.0), (0.0, 0.5))</code></pre><h5 id="[KagomeLattice](ref)"><a class="docs-heading-anchor" href="#[KagomeLattice](ref)"><a href="ref"><code>KagomeLattice</code></a></a><a id="[KagomeLattice](ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[KagomeLattice](ref)" title="Permalink"></a></h5><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; kagome = KagomeLattice()</code><code class="nohighlight hljs ansi" style="display:block;">KagomeLattice()</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_vectors(kagome)</code><code class="nohighlight hljs ansi" style="display:block;">((1.0, 0.0), (0.5, 0.8660254037844386))</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; lattice_sites(kagome)</code><code class="nohighlight hljs ansi" style="display:block;">((0.0, 0.0), (0.25, 0.4330127018922193), (0.75, 0.4330127018922193))</code></pre><h2 id="Generate-sites-and-sorting"><a class="docs-heading-anchor" href="#Generate-sites-and-sorting">Generate sites and sorting</a><a id="Generate-sites-and-sorting-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-sites-and-sorting" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms = generate_sites(Honeycomb(), 3, 5; scale=4.5)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: Honeycomb not defined</code></pre><p>where <code>scale</code> defines the unit distance (in <span>$\mu m$</span>) of the lattice. The return value is a <code>AtomList</code> instance. One can apply predefined filters to it, including</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; scale_axes(atoms, 0.8)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: scale_axes not defined</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; clip_axes(atoms, (0.0, 5.0), (0.0, 6.0))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: atoms not defined</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; offset_axes(atoms, 5.0, 5.0)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: atoms not defined</code></pre><p>To sort the atoms by the x-axis, one can convert these locations to a <a href="../ref/#EaRydLattices.MaskedGrid"><code>MaskedGrid</code></a> representation of the atoms.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; atoms_in_grid = make_grid(atoms)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: atoms not defined</code></pre><p>Then one can get the sorted atoms by typing</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; sorted_atoms = collect_atoms(atoms_in_grid)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: atoms_in_grid not defined</code></pre><h2 id="Query-neighbors"><a class="docs-heading-anchor" href="#Query-neighbors">Query neighbors</a><a id="Query-neighbors-1"></a><a class="docs-heading-anchor-permalink" href="#Query-neighbors" title="Permalink"></a></h2><p>One can use <a href="../ref/#EaRydLattices.make_kdtree-Union{Tuple{AtomList{D, T}}, Tuple{D}, Tuple{T}} where {T, D}"><code>make_kdtree</code></a> to generate a <a href="https://en.wikipedia.org/wiki/K-d_tree">k-d tree</a> data type for efficient querying neighborhoods in low dimensional space.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; tree = make_kdtree(sorted_atoms)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: sorted_atoms not defined</code></pre><p>The return value is a <a href="@ref"><code>KDTree</code></a> instance, which is defined in package <a href="https://github.com/KristofferC/NearestNeighbors.jl"><code>NearestNeigbors</code></a>. One can use it to query the neighbors of an atom, e.g. one can find the 20 nearest neighbors of the 5-th site by typing</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; neighbors = grouped_nearest(tree, 5, 20)</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: tree not defined</code></pre><p>The return value is a <a href="../ref/#EaRydLattices.DistanceGroup"><code>DistanceGroup</code></a> instance, and the indices of second nearest neighbors are</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; neighbors[2]</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: neighbors not defined</code></pre><p>One can select and display these atoms out by typing</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; img_atoms(sorted_atoms[neighbors[2]]; texts=string.(neighbors[2]))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: UndefVarError: neighbors not defined</code></pre><p>It show the correct second nearest neigbors of site 5.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../waveform/">« Waveforms</a><a class="docs-footer-nextpage" href="../hamiltonians/">Hamiltonians »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Wednesday 16 February 2022 04:32">Wednesday 16 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
