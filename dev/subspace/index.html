<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with Subspace · Bloqade.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/Bloqade.jl/subspace/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bloqade.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../waveform/">Waveforms</a></li><li><a class="tocitem" href="../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../registers/">Registers</a></li><li><a class="tocitem" href="../emulation/">Emulation</a></li><li class="is-active"><a class="tocitem" href>Working with Subspace</a><ul class="internal"><li><a class="tocitem" href="#Create-Blockade-Subspace"><span>Create Blockade Subspace</span></a></li><li><a class="tocitem" href="#Create-register-in-subspace"><span>Create register in subspace</span></a></li><li><a class="tocitem" href="#Obtain-matrix-of-Hamiltonian-in-subspace"><span>Obtain matrix of Hamiltonian in subspace</span></a></li><li><a class="tocitem" href="#Other-Operations-in-Subspace"><span>Other Operations in Subspace</span></a></li><li><a class="tocitem" href="#Create-constrained-local-Hamiltonian-using-subspace"><span>Create constrained local Hamiltonian using subspace</span></a></li></ul></li><li><a class="tocitem" href="../units/">Working with Units</a></li><li><a class="tocitem" href="../observables/">Observables</a></li><li><a class="tocitem" href="../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../cuda/">GPU Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../tutorials/noise/main/">Adiabatic Preparation with Sensitivity Analysis</a></li><li><a class="tocitem" href="../tutorials/qaoa/main/">The Maximum Independent Set Problem</a></li><li><a class="tocitem" href="../tutorials/quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../tutorials/ring/main/">Rydberg Blockade</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../topics/blockade/">Rydberg Blockade</a></li><li><a class="tocitem" href="../topics/bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../topics/ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../contrib/">Contributing to Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Working with Subspace</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with Subspace</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/Bloqade.jl/blob/master/docs/src/subspace.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="subspace"><a class="docs-heading-anchor" href="#subspace">Working with Subspace</a><a id="subspace-1"></a><a class="docs-heading-anchor-permalink" href="#subspace" title="Permalink"></a></h1><p>Due to the strong Rydberg interactions, only one Rydberg excitation is allowed within the blockade radius (see <a href="@ref">Rydberg Blockade</a>). This is the called blockade constraint.  In Bloqade, we take advantage of this effect by allowing users to run emulation in a truncated subspace.  This is done by throwing out states that violate the blockade constraint.  This process could help us accelerate the emulation and reach a bigger system size. In this section, we will show how to create a blockade subsapce, create register in subspace,  obtain Hamiltonian matrix in subspace, and run emulation in subspace. </p><h2 id="Create-Blockade-Subspace"><a class="docs-heading-anchor" href="#Create-Blockade-Subspace">Create Blockade Subspace</a><a id="Create-Blockade-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Blockade-Subspace" title="Permalink"></a></h2><p>One can create a blockade subspace via <code>blockade_subspace</code> method if we know the atomic positions </p><article class="docstring"><header><a class="docstring-binding" id="BloqadeMIS.blockade_subspace" href="#BloqadeMIS.blockade_subspace"><code>BloqadeMIS.blockade_subspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">blockade_subspace(atoms[, radius=1.0])</code></pre><p>Create a blockade approximation subspace from given atom positions and radius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Happy-Diode/Bloqade.jl/blob/1e63131709c3051479a9ae8e5eb6299b252118f1/lib/BloqadeMIS/src/subspace.jl#L44-L48">source</a></section></article><p>For example, we can construct a blockade subspace of a square lattice using the code below</p><pre><code class="language-julia hljs">using Bloqade
atoms = generate_sites(SquareLattice(), 3, 3, scale=5.1)
space = blockade_subspace(atoms, 5.2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9-qubits 63-elements Subspace{Vector{Int64}}:
───┬────
  1│ 0
  2│ 1
  3│ 2
   ⋮│ ⋮
 61│ 337
 62│ 340
 63│ 341</code></pre><p>where we have created a <span>$3*3$</span> square lattice with nearest neighbour atoms seperated by <span>$5.1 \mu m$</span>. Then we have created a blockade subpace with subspace radius being <span>$5.2 \mu m$</span>. This means that if two atoms have a distance that is smaller than (or equal to) <span>$5.2 \mu m$</span>, the blockade subspace does not contain states where both of them being in Rydberg states. The number of allowed states  is 63 in the above case, which is much smaller than the full Hilbert space 512. </p><p>Here <code>space</code> is of type <code>Subspace</code></p><article class="docstring"><header><a class="docstring-binding" id="BloqadeExpr.Subspace" href="#BloqadeExpr.Subspace"><code>BloqadeExpr.Subspace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Subspace{S &lt;: AbstractVector{Int}} &lt;: AbstractSpace</code></pre><p>A <code>Dict</code>-like object stores the mapping between subspace and full space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Happy-Diode/Bloqade.jl/blob/1e63131709c3051479a9ae8e5eb6299b252118f1/lib/BloqadeExpr/src/space.jl#L22-L26">source</a></section></article><p>Other than by using atomic poisitons and specifying the subspace radius, we can also using a graph to create a subspace. In this case, the subsapce  corresponds to the space composed by the <a href="https://en.wikipedia.org/wiki/Independent_set_(graph_theory)">independent set</a> of this graph. Bloqade has an explicit function for this, by using graph as  an input, and gives the subspace as the output. Here is an example code</p><pre><code class="language-julia hljs">using Graphs

g = SimpleGraph(5)
edge_set = [(1,2), (1, 4), (2, 5), (3, 4)]
for (i,j) in edge_set
    add_edge!(g, i, j)
end
space = independent_set_subspace(g)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-qubits 13-elements Subspace{Vector{Int64}}:
───┬───
  1│ 0
  2│ 1
  3│ 2
   ⋮│ ⋮
 11│ 20
 12│ 21
 13│ 24</code></pre><h2 id="Create-register-in-subspace"><a class="docs-heading-anchor" href="#Create-register-in-subspace">Create register in subspace</a><a id="Create-register-in-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-register-in-subspace" title="Permalink"></a></h2><p>One can create the register in subspace by feeding the <code>space</code> object instead of an integer for the common register interfaces, e.g</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; zero_state(space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(5, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; product_state(bit&quot;000_000_001&quot;, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(5, ComplexF64[0.0 + 0.0im, 1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code></pre><p>Or if you have an existing state stored as a subtype of <code>AbstractVector</code>, we can also create the register using the constructor</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; state = rand(ComplexF64, length(space))</code><code class="nohighlight hljs ansi" style="display:block;">13-element Vector{ComplexF64}:
   0.8204120800113129 + 0.6326199324715872im
 0.048090534970885335 + 0.5450518466975247im
   0.6121355179708723 + 0.6321352009107387im
   0.9176320999784984 + 0.13820789301912428im
  0.34558642527027883 + 0.8175429151390327im
   0.3330122669973691 + 0.7290635365003405im
   0.7766845209159342 + 0.8286102099018139im
   0.3141127495609287 + 0.8110571038211205im
   0.7812227856644022 + 0.6512076267097355im
   0.2661735286669319 + 0.37848380057131115im
   0.8949038031585634 + 0.5413751611057771im
     0.90182697650594 + 0.3342333197582813im
   0.7911613024549456 + 0.4497243064036802im</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; reg = SubspaceArrayReg(state, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(5, ComplexF64[0.8204120800113129 + 0.6326199324715872im, 0.048090534970885335 + 0.5450518466975247im, 0.6121355179708723 + 0.6321352009107387im, 0.9176320999784984 + 0.13820789301912428im, 0.34558642527027883 + 0.8175429151390327im, 0.3330122669973691 + 0.7290635365003405im, 0.7766845209159342 + 0.8286102099018139im, 0.3141127495609287 + 0.8110571038211205im, 0.7812227856644022 + 0.6512076267097355im, 0.2661735286669319 + 0.37848380057131115im, 0.8949038031585634 + 0.5413751611057771im, 0.90182697650594 + 0.3342333197582813im, 0.7911613024549456 + 0.4497243064036802im], Subspace{Vector{Int64}}(5, Dict(5 =&gt; 5, 16 =&gt; 9, 20 =&gt; 11, 24 =&gt; 13, 8 =&gt; 7, 17 =&gt; 10, 1 =&gt; 2, 0 =&gt; 1, 6 =&gt; 6, 4 =&gt; 4…), [0, 1, 2, 4, 5, 6, 8, 10, 16, 17, 20, 21, 24]))</code></pre><h2 id="Obtain-matrix-of-Hamiltonian-in-subspace"><a class="docs-heading-anchor" href="#Obtain-matrix-of-Hamiltonian-in-subspace">Obtain matrix of Hamiltonian in subspace</a><a id="Obtain-matrix-of-Hamiltonian-in-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Obtain-matrix-of-Hamiltonian-in-subspace" title="Permalink"></a></h2><p>The matrix projected in subspace of a given Hamiltonian can be obtained via <a href="../hamiltonians/#YaoAPI.mat"><code>mat</code></a> as well, e.g</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; h1 = rydberg_h(atoms; Δ=0.2, Ω=0.1)</code><code class="nohighlight hljs ansi" style="display:block;">nqubits: 9
+
├─ [+] ∑ 2π ⋅ 0.863e6.0/|r_i-r_j|^6 n_i n_j
├─ [+] 2π ⋅ 0.00796 ⋅ ∑ σ^x_i
└─ [-] 2π ⋅ 0.0318 ⋅ ∑ n_i</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mat(h1, space)</code><code class="nohighlight hljs ansi" style="display:block;">13×13 SparseArrays.SparseMatrixCSC{ComplexF64, Int64} with 52 stored entries:
      ⋅      0.05+0.0im  0.05+0.0im  …          ⋅              ⋅
 0.05+0.0im  -0.2+0.0im       ⋅                 ⋅              ⋅
 0.05+0.0im       ⋅      -0.2+0.0im             ⋅              ⋅
 0.05+0.0im       ⋅           ⋅                 ⋅              ⋅
      ⋅      0.05+0.0im       ⋅            0.05+0.0im          ⋅
      ⋅           ⋅      0.05+0.0im  …          ⋅              ⋅
 0.05+0.0im       ⋅           ⋅                 ⋅         0.05+0.0im
      ⋅           ⋅      0.05+0.0im             ⋅              ⋅
 0.05+0.0im       ⋅           ⋅                 ⋅         0.05+0.0im
      ⋅      0.05+0.0im       ⋅            0.05+0.0im          ⋅
      ⋅           ⋅           ⋅      …     0.05+0.0im          ⋅
      ⋅           ⋅           ⋅         81.2243+0.0im          ⋅
      ⋅           ⋅           ⋅                 ⋅      307.645+0.0im</code></pre><h2 id="Other-Operations-in-Subspace"><a class="docs-heading-anchor" href="#Other-Operations-in-Subspace">Other Operations in Subspace</a><a id="Other-Operations-in-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Other-Operations-in-Subspace" title="Permalink"></a></h2><p>All other operations in subspace are the same as fullspace case, e.g to run an emulation in subspace, one just need to use the subspace register <a href="../registers/#YaoSubspaceArrayReg.SubspaceArrayReg"><code>SubspaceArrayReg</code></a> instead of the fullspace register <a href="@ref"><code>ArrayReg</code></a>, the rest are all the same</p><pre><code class="language- hljs">reg = zero_state(space)
prob = SchrodingerProblem(reg, 0.1, h1)
emulate!(prob)
statevec(reg)</code></pre><p>The measurement in register with subspace is the same as that in the full space. </p><h2 id="Create-constrained-local-Hamiltonian-using-subspace"><a class="docs-heading-anchor" href="#Create-constrained-local-Hamiltonian-using-subspace">Create constrained local Hamiltonian using subspace</a><a id="Create-constrained-local-Hamiltonian-using-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-constrained-local-Hamiltonian-using-subspace" title="Permalink"></a></h2><p>Although we are able to emulate our Hamiltonian problem in the projected subspace, the long-range tail of   the Rydberg interactions will be present in the subspace Hamiltonian. In certain cases, the user may want to  cut off the long-range tail by only simulating a constrained short-range Hamiltonian, e.g. <a href="https://arxiv.org/abs/2011.09486">the PXP model</a>.  In this case, we are able to using Bloqade to easily deal with such problem for arbitrary graph in arbitrary dimension. </p><p>Let us take the PXP model in 1D as an example. We first create a 1D chain, and then generate a subspace by projecting out states without nearest-neighbour interactions. </p><pre><code class="language- hljs">using Bloqade
atoms = generate_sites(ChainLattice(), 10, scale=5.1)
space = blockade_subspace(atoms, 5.2)
register = product_state(bit&quot;0101010101&quot;, space)
h = 4π * SumOfX(length(atoms)) 
prob = SchrodingerProblem(reg, 0.2, h)
emulate!(prob)</code></pre><p>After creating the subspace, we have built a Hamiltonian by explicitly summing up the Rabi frequency term  and the detuning term by using [<code>XTerm</code>]@(ref) [<code>NTerm</code>]@(ref) respectively.  In this way, we have created a local constraint Hamiltonian (without long-range tailed interactions). Futhermore, if we want to emulate  quantum dynamics under this Hamiltonian, we just need to create a subspace register and emulate the system under the created Hamiltonian. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../emulation/">« Emulation</a><a class="docs-footer-nextpage" href="../units/">Working with Units »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Saturday 23 April 2022 00:27">Saturday 23 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
