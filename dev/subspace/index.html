<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Working with Subspace · Bloqade.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/Bloqade.jl/subspace/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Bloqade.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../install/">Installation</a></li><li><a class="tocitem" href="../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../waveform/">Waveforms</a></li><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../registers/">Registers</a></li><li><a class="tocitem" href="../emulation/">Emulation</a></li><li class="is-active"><a class="tocitem" href>Working with Subspace</a><ul class="internal"><li><a class="tocitem" href="#Blockade-Subspace"><span>Blockade Subspace</span></a></li><li><a class="tocitem" href="#Create-register-in-subspace"><span>Create register in subspace</span></a></li><li><a class="tocitem" href="#Obtain-matrix-of-Hamiltonian-in-subspace"><span>Obtain matrix of Hamiltonian in subspace</span></a></li><li><a class="tocitem" href="#Run-emulation-in-subspace"><span>Run emulation in subspace</span></a></li></ul></li><li><a class="tocitem" href="../observables/">Observables</a></li><li><a class="tocitem" href="../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../cuda/">CUDA Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../tutorials/noise/main/">Adiabatic Preparation with Sensitivity Analysis</a></li><li><a class="tocitem" href="../tutorials/quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../tutorials/ring/main/">Ring Emulation</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../topics/blockade/">Rydberg Blockade</a></li><li><a class="tocitem" href="../topics/bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../topics/ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../contrib/">Contributing Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Working with Subspace</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Working with Subspace</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/Bloqade.jl/blob/master/docs/src/subspace.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="subspace"><a class="docs-heading-anchor" href="#subspace">Working with Subspace</a><a id="subspace-1"></a><a class="docs-heading-anchor-permalink" href="#subspace" title="Permalink"></a></h1><h2 id="Blockade-Subspace"><a class="docs-heading-anchor" href="#Blockade-Subspace">Blockade Subspace</a><a id="Blockade-Subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Blockade-Subspace" title="Permalink"></a></h2><p>The blockade subspace of Rydberg system can be used to reduce Hilbert space size so that one can approximate large system using relatively small space.</p><p>One can create a blockade subspace via <code>blockade_subspace</code> method</p><article class="docstring"><header><a class="docstring-binding" id="BloqadeMIS.blockade_subspace" href="#BloqadeMIS.blockade_subspace"><code>BloqadeMIS.blockade_subspace</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">blockade_subspace(atoms[, radius=1.0])</code></pre><p>Create a blockade approximation subspace from given atom positions and radius.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Happy-Diode/Bloqade.jl/blob/fd978f65c1cc21a49d3b5c881eab23549d1177e9/lib/BloqadeMIS/src/subspace.jl#L44-L48">source</a></section></article><p>For example, we can construct a blockade subspace of a square lattice with random dropout.</p><pre><code class="language-julia hljs">using Bloqade
atoms = generate_sites(SquareLattice(), 3, 3, scale=5.1)
space = blockade_subspace(atoms, 5.1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">9-qubits 63-elements Subspace{Vector{Int64}}:
───┬────
  1│ 0
  2│ 1
  3│ 2
   ⋮│ ⋮
 61│ 337
 62│ 340
 63│ 341</code></pre><p>here <code>space</code> is of type <code>Subspace</code></p><article class="docstring"><header><a class="docstring-binding" id="BloqadeExpr.Subspace" href="#BloqadeExpr.Subspace"><code>BloqadeExpr.Subspace</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Subspace{S &lt;: AbstractVector{Int}} &lt;: AbstractSpace</code></pre><p>A <code>Dict</code>-like object stores the mapping between subspace and full space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Happy-Diode/Bloqade.jl/blob/fd978f65c1cc21a49d3b5c881eab23549d1177e9/lib/BloqadeExpr/src/space.jl#L22-L26">source</a></section></article><h2 id="Create-register-in-subspace"><a class="docs-heading-anchor" href="#Create-register-in-subspace">Create register in subspace</a><a id="Create-register-in-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Create-register-in-subspace" title="Permalink"></a></h2><p>One can create the register in subspace by feeding the <code>space</code> object instead of an integer for the common register interfaces, e.g</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; zero_state(space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(9, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im  …  0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Vector{Int64}}(9, Dict(5 =&gt; 5, 268 =&gt; 50, 325 =&gt; 59, 32 =&gt; 13, 136 =&gt; 35, 272 =&gt; 51, 320 =&gt; 55, 337 =&gt; 61, 64 =&gt; 18, 324 =&gt; 58…), [0, 1, 2, 4, 5, 8, 10, 12, 16, 17  …  277, 320, 321, 322, 324, 325, 336, 337, 340, 341]))</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; product_state(bit&quot;000_000_001&quot;, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(9, ComplexF64[0.0 + 0.0im, 1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im  …  0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Vector{Int64}}(9, Dict(5 =&gt; 5, 268 =&gt; 50, 325 =&gt; 59, 32 =&gt; 13, 136 =&gt; 35, 272 =&gt; 51, 320 =&gt; 55, 337 =&gt; 61, 64 =&gt; 18, 324 =&gt; 58…), [0, 1, 2, 4, 5, 8, 10, 12, 16, 17  …  277, 320, 321, 322, 324, 325, 336, 337, 340, 341]))</code></pre><p>Or if you have an existing state stored as a subtype of <code>AbstractVector</code>, we can also create the register using the constructor</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; state = rand(ComplexF64, length(space))</code><code class="nohighlight hljs ansi" style="display:block;">63-element Vector{ComplexF64}:
   0.3399157180940636 + 0.924236697298882im
   0.5867289020876604 + 0.8191297445595835im
  0.49385053757950315 + 0.4187407176529422im
   0.6376876128355154 + 0.12663089752325685im
   0.4614300989340152 + 0.4156569178464331im
   0.5681866562685137 + 0.8841845733819437im
 0.014585443945154264 + 0.7712786153950936im
  0.13946499162085513 + 0.38632014513164536im
    0.282132181234087 + 0.6800236012477808im
  0.34571771418614927 + 0.9398536245263738im
                      ⋮
   0.9669212990089098 + 0.7143505109282321im
   0.7720213896993074 + 0.055242047888628076im
   0.3522224599449151 + 0.263217089501788im
 0.044352207863328164 + 0.920187777012304im
  0.39235122226786434 + 0.5473784445384109im
  0.10872402885817023 + 0.4349196749109342im
   0.5367072793552865 + 0.6555063969906728im
   0.5981792121671294 + 0.8028083282291557im
   0.8862766253768488 + 0.437590883693743im</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; reg = SubspaceArrayReg(state, space)</code><code class="nohighlight hljs ansi" style="display:block;">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(9, ComplexF64[0.3399157180940636 + 0.924236697298882im, 0.5867289020876604 + 0.8191297445595835im, 0.49385053757950315 + 0.4187407176529422im, 0.6376876128355154 + 0.12663089752325685im, 0.4614300989340152 + 0.4156569178464331im, 0.5681866562685137 + 0.8841845733819437im, 0.014585443945154264 + 0.7712786153950936im, 0.13946499162085513 + 0.38632014513164536im, 0.282132181234087 + 0.6800236012477808im, 0.34571771418614927 + 0.9398536245263738im  …  0.1290212849974911 + 0.9000195518011971im, 0.9669212990089098 + 0.7143505109282321im, 0.7720213896993074 + 0.055242047888628076im, 0.3522224599449151 + 0.263217089501788im, 0.044352207863328164 + 0.920187777012304im, 0.39235122226786434 + 0.5473784445384109im, 0.10872402885817023 + 0.4349196749109342im, 0.5367072793552865 + 0.6555063969906728im, 0.5981792121671294 + 0.8028083282291557im, 0.8862766253768488 + 0.437590883693743im], Subspace{Vector{Int64}}(9, Dict(5 =&gt; 5, 268 =&gt; 50, 325 =&gt; 59, 32 =&gt; 13, 136 =&gt; 35, 272 =&gt; 51, 320 =&gt; 55, 337 =&gt; 61, 64 =&gt; 18, 324 =&gt; 58…), [0, 1, 2, 4, 5, 8, 10, 12, 16, 17  …  277, 320, 321, 322, 324, 325, 336, 337, 340, 341]))</code></pre><h2 id="Obtain-matrix-of-Hamiltonian-in-subspace"><a class="docs-heading-anchor" href="#Obtain-matrix-of-Hamiltonian-in-subspace">Obtain matrix of Hamiltonian in subspace</a><a id="Obtain-matrix-of-Hamiltonian-in-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Obtain-matrix-of-Hamiltonian-in-subspace" title="Permalink"></a></h2><p>The matrix in subspace of a given Hamiltonian can be obtained via <a href="../hamiltonians/#YaoAPI.mat"><code>mat</code></a> as well, e.g</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; h1 = rydberg_h(atoms; Δ=0.2, Ω=0.1)</code><code class="nohighlight hljs ansi" style="display:block;">nqubits: 9
+
├─ [+] ∑ 5.42e6/|r_i-r_j|^6 n_i n_j
├─ [+] 0.05 ⋅ ∑ σ^x_i
└─ [-] 0.2 ⋅ ∑ n_i</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mat(h1, space)</code><code class="nohighlight hljs ansi" style="display:block;">63×63 SparseArrays.SparseMatrixCSC{ComplexF64, Int64} with 366 stored entries:
⡞⢍⡊⢄⠑⡀⠑⠄⠈⠢⡀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠊⢌⢱⢖⠀⠈⠀⠐⠄⠀⠈⠀⠀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀
⠑⠠⡀⠀⢟⣵⠀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀
⠑⠄⢀⠀⠀⠀⡟⢍⡄⠀⠀⠀⠀⠑⠄⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠢⡀⠀⠁⠀⠀⠀⠉⢱⢖⠢⠢⠀⠢⡀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠢⡀⠀⠀⠀
⠀⠈⠂⠀⢄⠀⠀⠀⠨⡂⠛⣤⢕⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⡀⠀
⠀⠀⠀⠀⠀⠑⢄⠀⠠⡀⠑⠑⠛⣤⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠂
⠢⡀⠀⠀⠀⠀⠀⠁⠀⠈⠀⠀⠀⠁⢱⢖⠢⢂⠐⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠨⢂⠛⣤⠅⠀⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠈⠀⠀⠢⡀⠀⠀⠀⠀⠀⠀⠐⢄⠁⠁⢱⢖⢂⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢄⠀⠀⠀⠀⠀⠀⠈⠂⠀⠀⠀⠀⠀⠀⠀⠀⠑⠈⠐⠛⣤⠤⡠⠀⢄⠀⢄⠀⠀⠀⠀
⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡣⠱⢆⣑⠀⠢⠀⠑⠄⠀⠀
⠀⠀⠀⠑⢄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢄⠑⠘⠑⣤⢄⠀⠀⠠⡀⠀
⠀⠀⠀⠀⠀⠑⠀⠀⠠⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢄⠈⠂⠀⠑⠛⣤⠤⡠⡈⠂
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠑⠄⠀⡀⠀⡣⠱⢆⣐⠄
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠢⠈⠐⠜⠵⠇</code></pre><h2 id="Run-emulation-in-subspace"><a class="docs-heading-anchor" href="#Run-emulation-in-subspace">Run emulation in subspace</a><a id="Run-emulation-in-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Run-emulation-in-subspace" title="Permalink"></a></h2><p>To run an emulation in subspace, one just need to use the subspace register <a href="../registers/#YaoSubspaceArrayReg.SubspaceArrayReg"><code>SubspaceArrayReg</code></a> instead of the fullspace register <a href="@ref"><code>ArrayReg</code></a>, e.g</p><pre><code class="language-julia hljs">reg = zero_state(space)
prob = SchrodingerProblem(reg, 0.1, h1)
emulate!(prob)
statevec(reg)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">63-element Vector{ComplexF64}:
      0.9998875080438233 - 7.504946049157891e-7im
   5.0032497847347784e-5 - 0.004999251507258856im
   5.0053030945244255e-5 - 0.004999314221486945im
   5.0032497847347784e-5 - 0.004999251507258856im
  -2.4612854635237814e-5 + 3.4765118514380558e-6im
   5.0053030945244255e-5 - 0.004999314221486945im
   -6.242807940446212e-6 + 1.5175720212216836e-5im
   -2.491792354747906e-5 + 1.5500081652252594e-6im
   5.0094374710619485e-5 - 0.004999398211485008im
   -6.242865783388495e-6 + 1.5175783577086303e-5im
                         ⋮
  -2.4612854635237814e-5 + 3.476511851438081e-6im
   3.7505269426067387e-8 + 1.1692532807943287e-7im
   3.5712789146242494e-8 + 1.1785969092137277e-7im
   3.7505269426067387e-8 + 1.1692532807943287e-7im
   4.779143872014385e-10 - 3.552389743749648e-10im
   2.7574198187366123e-8 - 2.1622349961822024e-8im
  -8.239633251732503e-11 - 1.4364966029376588e-11im
  -8.239633251732503e-11 - 1.4364966029376588e-11im
 -3.2703880406085607e-12 + 3.4230106249855768e-12im</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../emulation/">« Emulation</a><a class="docs-footer-nextpage" href="../observables/">Observables »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 15 April 2022 04:08">Friday 15 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
