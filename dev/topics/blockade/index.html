<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rydberg Blockade · Bloqade.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/Bloqade.jl/topics/blockade/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Bloqade.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><a class="tocitem" href="../../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../waveform/">Waveforms</a></li><li><a class="tocitem" href="../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../../registers/">Registers</a></li><li><a class="tocitem" href="../../emulation/">Emulation</a></li><li><a class="tocitem" href="../../subspace/">Working with Subspace</a></li><li><a class="tocitem" href="../../observables/">Observables</a></li><li><a class="tocitem" href="../../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../../cuda/">CUDA Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../../tutorials/noise/main/">Adiabatic Preparation with Sensitivity Analysis</a></li><li><a class="tocitem" href="../../tutorials/quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../../tutorials/ring/main/">Ring Emulation</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li class="is-active"><a class="tocitem" href>Rydberg Blockade</a></li><li><a class="tocitem" href="../bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../../contrib/">Contributing Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Advanced Topics</a></li><li class="is-active"><a href>Rydberg Blockade</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rydberg Blockade</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/Bloqade.jl/blob/master/docs/src/topics/blockade.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="blockade"><a class="docs-heading-anchor" href="#blockade">Rydberg Blockade</a><a id="blockade-1"></a><a class="docs-heading-anchor-permalink" href="#blockade" title="Permalink"></a></h1><p>The Rydberg blockade mechanism is a crucial component of the operation of neutral atom computers. By including a term in the effective Hamiltonian which adds an interaction between adjacent Rydberg atoms, we may construct gates and nontrivial dynamics which create entanglement and correlation across the system.</p><p>The term is a van der Waals interaction where there is an energy shift if two adjacent atoms are in the Rydberg state. The Van der Waals interaction is</p><p class="math-container">\[V_{ij} = \frac{C_6}{|\vec r_i - \vec r_j|^6}\hat n_i \hat n_j\]</p><p>where <span>$\hat n_i=|r_i\rangle\langle r_i|$</span> is the number operator on the <span>$i$</span>th site, which is 1 if the atom is in the Rydberg state, and zero if the atom is in the ground state. The coefficeint <span>$C_6 = 2\pi\times 862690 MHz/\mu m^6$</span> is the interaction strength; characteristically, this interaction has a strength <span>$\approx 10MHz$</span> for two atoms seperated by <span>$10\mu m$</span>, a similar scale to the Rabi coupling between the ground and Rydberg state. Crucially, this can be seen as an energy shift on atom <span>$j$</span>, conditional on the state of atom <span>$i$</span>, and so can be used, in a loose sense, as a conditional logical gate. This is because the adjacent atom forces the atom to be off-resonant with the laser field.</p><p>This conditional drive can be seen given the following dynamics. Suppose two atoms are close to each other (<span>$&lt; 10 \mu m$</span>) and so interact under van der Waals. The left atom is either in a Rydberg state, or in the ground state, and the right atom is originally in the ground state. Then, a Rabi drive is applied to the right atom, which couples the atom&#39;s ground state to the Rydberg state. For this example, we choose a Rabi drive of <span>$\Omega=2\pi\times 0.5$</span>MHz and distance between atoms <span>$|\vec r_i- \vec r_j| = 7\mu m$</span>, which gives a conditional detuning of <span>$\approx 50$</span>MHz. When the left atom is in the ground state (black, top), there are no interactions and the state of the right atom oscillates between the ground state and Rydberg state; for a particular choice of timing this executes a <span>$\pi$</span> pulse, flipping the right atom from the ground to Rydberg state. However, when the left atom is in the Rydberg state (red, bottom), there is a large detuning on the right atom, which causes the transfer to the Rydberg state to be strongly suppressed. In this case, the right atom (up to perturbative corrections) is never in the Rydberg state.</p><p><img src="../../assets/RydbergBlockade.png" alt="RydbergBlockade"/></p><p>This conditional energy shift is the basis of the <strong>Rydberg Blockade</strong>. Because of the large energy shift from having two adjacent atoms in the Rydberg state, evolution from an atomic ground state with local Rabi couplings between ground and Rydberg is restricted to a low energy subspace of states where no two adjacent atoms are in the Rydberg state. Furthermore, because the interaction strength with distance is a large power law, one can define a characteristic scale set by the Rabi coupling. If two atoms are close such that the conditional detuning is much larger than the Rabi coupling, one can consider the atoms to be blockading each other, and both atoms cannot simultaniously be in the Rydberg state. In contrast, if two atoms are far away, the two atoms never blockade each other and both atoms can simultaniously be in the Rydberg state.</p><p>The allowed states are then <strong>independent sets</strong> of a <strong>unit disk graph</strong> defined by the positions of the atoms. A unit disk graph is a set of vertices and edges, where vertices represent every atom, and there are edges if the distance between vertices is less than some radius <span>$|\vec r_i- \vec r_j|&lt;R$</span>, given by the characteristic Rabi frequency and van der Walls detuning. The blockade constraint is incoded by independent sets, which are subsets  <span>$S$</span> of vertices of the unit disk graph such that no two vertices in <span>$S$</span> are adjacent. The number of independent sets in a graph is much smaller than the number of subsets of the graph, so correspondingly the Hilbert space of quantum evolution is much smaller. This subspace constraint can thus speed quantum simulation considerably, at very little cost.</p><p>To emphisize the effectiveness of this independent set subspace, some example nonequilibrium dynamics are shown below, for a ring of 12 atoms seperated by <span>$7\mu m$</span>. This set of atoms can be defined by</p><pre><code class="language-julia hljs">using Bloqade
nsites = 12;    # 12 site chain
distance = 7    # Distance between atoms, in microns

R = distance/(2*sin(2*pi/(nsites)/2))                                       # Radius of the circle, using a little trigonometry
pos = [(R*sin(i*2*pi/(nsites)), R*cos(i*2*pi/(nsites)) ) for i in 1:nsites] # Positions of each atom
atoms = AtomList(pos)                                                       # Define the atom positions as an AtomList.</code></pre><?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.2"
     width="120mm" height="120mm" viewBox="0 0 120 120"
     stroke="none"
     fill="#000000"
     stroke-width="0.3"
     font-size="3.88"
>
<defs>
  <marker id="arrow" markerWidth="15" markerHeight="7" refX="5" refY="3.5" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L15,3.5 L0,7 z" stroke="context-stroke" fill="context-stroke"/>
  </marker>
</defs>
<g fill="#000000" font-size="3.88" id="img-c32cd9e3-1">
  <g transform="translate(28.71,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-13.52μm</text>
    </g>
  </g>
  <g transform="translate(49.57,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-4.51μm</text>
    </g>
  </g>
  <g transform="translate(70.43,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4.51μm</text>
    </g>
  </g>
  <g transform="translate(91.29,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">13.52μm</text>
    </g>
  </g>
  <g transform="translate(14.36,91.29)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-13.52μm</text>
    </g>
  </g>
  <g transform="translate(14.36,70.43)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-4.51μm</text>
    </g>
  </g>
  <g transform="translate(14.36,49.57)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4.51μm</text>
    </g>
  </g>
  <g transform="translate(14.36,28.71)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">13.52μm</text>
    </g>
  </g>
</g>
<g stroke-width="0.78" fill="#FFFFFF" stroke="#000000" id="img-c32cd9e3-2">
  <g transform="translate(75.64,32.9)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(87.1,44.36)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(91.29,60)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(87.1,75.64)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(75.64,87.1)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(60,91.29)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(44.36,87.1)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(32.9,75.64)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(28.71,60)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(32.9,44.36)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(44.36,32.9)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(60,28.71)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
</g>
<g fill="#000000" font-size="4.57" id="img-c32cd9e3-3">
  <g transform="translate(75.64,32.9)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">1</text>
    </g>
  </g>
  <g transform="translate(87.1,44.36)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">2</text>
    </g>
  </g>
  <g transform="translate(91.29,60)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">3</text>
    </g>
  </g>
  <g transform="translate(87.1,75.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4</text>
    </g>
  </g>
  <g transform="translate(75.64,87.1)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">5</text>
    </g>
  </g>
  <g transform="translate(60,91.29)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">6</text>
    </g>
  </g>
  <g transform="translate(44.36,87.1)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">7</text>
    </g>
  </g>
  <g transform="translate(32.9,75.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">8</text>
    </g>
  </g>
  <g transform="translate(28.71,60)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">9</text>
    </g>
  </g>
  <g transform="translate(32.9,44.36)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">10</text>
    </g>
  </g>
  <g transform="translate(44.36,32.9)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">11</text>
    </g>
  </g>
  <g transform="translate(60,28.71)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">12</text>
    </g>
  </g>
</g>
</svg>
<p>The system is driven by a constant <span>$2\pi \times 0.5$</span>MHz Rabi drive, which couples each atom&#39;s ground and Rydberg state. This can be defined using a Hamiltonian</p><pre><code class="language-julia hljs">h = rydberg_h(atoms;C = 2π * 858386, Ω=π)</code></pre><p class="math-container">\[\sum \frac{5.39e6}{|r_i-r_j|^6} n_i n_j+1\cdot1.57 ⋅ \sum σ^x_i\]</p><p>The system is initialized into the ground state of all atoms. We have two choices of basis: the first choice is the full Hilbert space of <span>$2^12$</span> elements, wheras the second basis is the blockade subspace, which excludes Rydberg excitations within the unit disk radius. The blockade subspace has <span>$D=322$</span> elements, which means that computation is much faster.</p><pre><code class="language-julia hljs">init_state = zero_state(nsites)                       # Initial state in the full space
space = blockade_subspace(atoms,distance*1.1)   # Compute the blockade subspace
init_state2 = zero_state(space)                       # Define the initial state in the blockade subspace.</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SubspaceArrayReg{Vector{ComplexF64}, Subspace{Vector{Int64}}}(12, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im  …  0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], Subspace{Vector{Int64}}(12, Dict(2050 =&gt; 235, 2594 =&gt; 298, 1033 =&gt; 151, 2632 =&gt; 305, 1028 =&gt; 148, 2312 =&gt; 271, 2688 =&gt; 310, 1296 =&gt; 208, 2324 =&gt; 275, 673 =&gt; 138…), [0, 1, 2, 4, 5, 8, 9, 10, 16, 17  …  2696, 2698, 2704, 2706, 2708, 2720, 2722, 2724, 2728, 2730]))</code></pre><p>If the atoms were far apart and non-interacting, each atom would oscillate completely between its ground state and Rydberg state with a period of <span>$0.5 \mu$</span>s. However, because adjacent atoms shift to the Rydberg state concurrently, they are dynamically blockaded, causing the maximum Rydberg density to only be 1/2, corresponding to an antiferromagnetic <span>$Z_2$</span> state. Note that because the ring has a translation symmetry, the Rydberg density is equal on all sites.</p><pre><code class="language- hljs"># Define the time steps
Tmax = 10.
nsteps = 5001
times = LinRange(0,Tmax,nsteps)


# Time evolve the system in the full space
prob = SchrodingerProblem(init_state, Tmax, h, dt = Tmax/(nsteps-1) , adaptive = false);
integrator = init(prob, Vern6());

densities = []
for _ in TimeChoiceIterator(integrator, 0.0:Tmax/(nsteps-1):Tmax)
    push!(densities, expect(put(nsites, 1=&gt;Op.n), init_state))
end


# Time evolve the system in the subspace
prob2 = SchrodingerProblem(init_state2, Tmax, h, dt = Tmax/(nsteps-1) , adaptive = false);
integrator2 = init(prob2, Vern8());

densities2 = []
for _ in TimeChoiceIterator(integrator2, 0.0:Tmax/(nsteps-1):Tmax)
    push!(densities2, expect(put(nsites, 1=&gt;Op.n), init_state2))#, SubspaceArrayReg(u, space)))
end


# Plot the data
fig = plt.figure(figsize=(8,6))
ax  = plt.subplot(1,1,1)

plt.plot(times,real(densities),&quot;k&quot;,label=&quot;Full space&quot;)
plt.plot(times,real(densities2),&quot;r--&quot;,label=&quot;Subspace&quot;)
ax.axis([0,Tmax,0,0.45])
plt.xlabel(&quot;Time (us)&quot;)
plt.ylabel(&quot;Rydberg density&quot;)
plt.tight_layout()
plt.legend()

# Using matplotlib plots
inset_axes = pyimport(&quot;mpl_toolkits.axes_grid1.inset_locator&quot;)
ax2 = inset_axes.inset_axes(ax,width=&quot;20%&quot;,height=&quot;30%&quot;,loc=&quot;lower right&quot;,borderpad=1)
plt.plot(times,real(densities - densities2))
plt.axis([0,0.6,-0.0008,0.0008])
plt.ylabel(&quot;Difference&quot;,fontsize=12)
plt.yticks(LinRange(-0.0008,0.0008,5),fontsize=12)
plt.xticks([0,0.2,0.4,0.6],fontsize=12)</code></pre><p><img src="../../assets/RydbergBlockadeSubspace.png" alt="RydbergBlockadeSubspace"/></p><p>Data for this evolution is shown above, where exact evolution in the full space is shown in black, and the truncated evolution in the subspace is shown by red dashed. It is clear that even though the Hilbert space is <span>$12\times$</span> smaller, the dynamics are faithfully reproduced, up to high frequency oscillations (inset) from adjacent atoms in the Rydberg state, similar to the high frequency oscillations of the 2 atom conditional blockade example. However, at longer times this subspace approximation fails to reproduce the full space (shown by divergence between black and red dashed). Note that for this example, the distance between atoms was chosen to be in an intermediate regime (eg, at the edge of the unit disk), which reduces the blockade effect and amplifies the approximate nature of the blockade. If the atoms were chosen to be closer together (say, <span>$5\mu m$</span>) or the Rabi strength was reduced, the blockade approximation becomes much stronger.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/ring/main/">« Ring Emulation</a><a class="docs-footer-nextpage" href="../bravais/">Bravais Lattice »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 15 April 2022 14:01">Friday 15 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
