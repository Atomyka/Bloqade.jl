<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ring Emulation · Bloqade.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/Bloqade.jl/tutorials/ring/main/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Bloqade.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../install/">Installation</a></li><li><a class="tocitem" href="../../../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../waveform/">Waveforms</a></li><li><a class="tocitem" href="../../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../../../registers/">Registers</a></li><li><a class="tocitem" href="../../../emulation/">Emulation</a></li><li><a class="tocitem" href="../../../subspace/">Working with Subspace</a></li><li><a class="tocitem" href="../../../observables/">Observables</a></li><li><a class="tocitem" href="../../../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../../../cuda/">CUDA Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../adiabatic/main/">Adiabatic Evolution</a></li><li><a class="tocitem" href="../../noise/main/">Adiabatic Preparation with Sensitivity Analysis</a></li><li><a class="tocitem" href="../../quantum-scar/main/">Quantum Scar</a></li><li class="is-active"><a class="tocitem" href>Ring Emulation</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Emulate-the-problem"><span>Emulate the problem</span></a></li></ul></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../../../topics/blockade/">Rydberg Blockade</a></li><li><a class="tocitem" href="../../../topics/bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../../../topics/ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../../../contrib/">Contributing Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Ring Emulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ring Emulation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/Bloqade.jl/blob/master/examples/ring/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Ring-Emulation"><a class="docs-heading-anchor" href="#Ring-Emulation">Ring Emulation</a><a id="Ring-Emulation-1"></a><a class="docs-heading-anchor-permalink" href="#Ring-Emulation" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Bloqade</code></pre><p>Use matplotlib to generate plots for windows users you may need to use the following commands</p><pre><code class="language-julia hljs">matplotlib = pyimport(&quot;matplotlib&quot;)
matplotlib.use(&quot;TkAgg&quot;)</code></pre><pre><code class="language-julia hljs">using PythonCall
plt = pyimport(&quot;matplotlib.pyplot&quot;)
plt.rcParams[&quot;font.size&quot;] = 22</code></pre><pre><code class="nohighlight hljs">22</code></pre><p>Simulate nonequilibrium dynamics of a 12-site ring of Rydberg atoms. This script generates Figure 2 in the example RydbergBlockade.</p><p>First, define the geometry of the system, a ring of 12 sites.</p><pre><code class="language-julia hljs">nsites = 12;    # 12 site chain
distance = 7    # Distance between atoms, in microns

R = distance/(2*sin(2*pi/(nsites)/2))                                       # Radius of the circle, using a little trigonometry
pos = [(R*sin(i*2*pi/(nsites)), R*cos(i*2*pi/(nsites)) ) for i in 1:nsites] # Positions of each atom
atoms = AtomList(pos)                                                       # Define the atom positions as an AtomList.</code></pre><?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.2"
     width="120mm" height="120mm" viewBox="0 0 120 120"
     stroke="none"
     fill="#000000"
     stroke-width="0.3"
     font-size="3.88"
>
<defs>
  <marker id="arrow" markerWidth="15" markerHeight="7" refX="5" refY="3.5" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L15,3.5 L0,7 z" stroke="context-stroke" fill="context-stroke"/>
  </marker>
</defs>
<g fill="#000000" font-size="3.88" id="img-16e006bc-1">
  <g transform="translate(28.71,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-13.52μm</text>
    </g>
  </g>
  <g transform="translate(49.57,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-4.51μm</text>
    </g>
  </g>
  <g transform="translate(70.43,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4.51μm</text>
    </g>
  </g>
  <g transform="translate(91.29,102.77)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">13.52μm</text>
    </g>
  </g>
  <g transform="translate(14.36,91.29)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-13.52μm</text>
    </g>
  </g>
  <g transform="translate(14.36,70.43)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">-4.51μm</text>
    </g>
  </g>
  <g transform="translate(14.36,49.57)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4.51μm</text>
    </g>
  </g>
  <g transform="translate(14.36,28.71)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">13.52μm</text>
    </g>
  </g>
</g>
<g stroke-width="0.78" fill="#FFFFFF" stroke="#000000" id="img-16e006bc-2">
  <g transform="translate(75.64,32.9)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(87.1,44.36)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(91.29,60)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(87.1,75.64)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(75.64,87.1)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(60,91.29)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(44.36,87.1)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(32.9,75.64)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(28.71,60)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(32.9,44.36)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(44.36,32.9)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
  <g transform="translate(60,28.71)">
    <circle cx="0" cy="0" r="3.89" class="primitive"/>
  </g>
</g>
<g fill="#000000" font-size="4.57" id="img-16e006bc-3">
  <g transform="translate(75.64,32.9)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">1</text>
    </g>
  </g>
  <g transform="translate(87.1,44.36)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">2</text>
    </g>
  </g>
  <g transform="translate(91.29,60)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">3</text>
    </g>
  </g>
  <g transform="translate(87.1,75.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4</text>
    </g>
  </g>
  <g transform="translate(75.64,87.1)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">5</text>
    </g>
  </g>
  <g transform="translate(60,91.29)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">6</text>
    </g>
  </g>
  <g transform="translate(44.36,87.1)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">7</text>
    </g>
  </g>
  <g transform="translate(32.9,75.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">8</text>
    </g>
  </g>
  <g transform="translate(28.71,60)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">9</text>
    </g>
  </g>
  <g transform="translate(32.9,44.36)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">10</text>
    </g>
  </g>
  <g transform="translate(44.36,32.9)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">11</text>
    </g>
  </g>
  <g transform="translate(60,28.71)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">12</text>
    </g>
  </g>
</g>
</svg>
<p>Build the Hamiltonian by defining the atom list and the Rabi frequency Here, the Rabi frequency Ω is π, such that one oscillation occurs in 0.5usec.</p><pre><code class="language-julia hljs">h = rydberg_h(atoms;C = 2π * 858386, Ω=π)</code></pre><pre><code class="nohighlight hljs">nqubits: 12
+
├─ [+] ∑ 5.39e6/|r_i-r_j|^6 n_i n_j
└─ [+] 1.57 ⋅ ∑ σ^x_i
</code></pre><h1 id="Emulate-the-problem"><a class="docs-heading-anchor" href="#Emulate-the-problem">Emulate the problem</a><a id="Emulate-the-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Emulate-the-problem" title="Permalink"></a></h1><p>State in the full space</p><pre><code class="language-julia hljs">init_state = zero_state(nsites)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 12/12
    nlevel: 2</code></pre><p>State in the blockade subspace</p><pre><code class="language-julia hljs">space = blockade_subspace(atoms,distance*1.1)   # Compute the blockade subspace
init_state2 = zero_state(space)                       # Define the initial state in the blockade subspace.</code></pre><pre><code class="nohighlight hljs">YaoSubspaceArrayReg.SubspaceArrayReg{Vector{ComplexF64}, BloqadeExpr.Subspace{Vector{Int64}}}(12, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], BloqadeExpr.Subspace{Vector{Int64}}(12, Dict(2050 =&gt; 235, 2594 =&gt; 298, 1033 =&gt; 151, 2632 =&gt; 305, 1028 =&gt; 148, 2312 =&gt; 271, 2688 =&gt; 310, 1296 =&gt; 208, 2324 =&gt; 275, 673 =&gt; 138, 73 =&gt; 28, 1188 =&gt; 195, 657 =&gt; 133, 1090 =&gt; 168, 2592 =&gt; 297, 584 =&gt; 116, 544 =&gt; 103, 168 =&gt; 53, 2132 =&gt; 254, 1193 =&gt; 198, 1092 =&gt; 169, 2722 =&gt; 319, 676 =&gt; 140, 1168 =&gt; 187, 264 =&gt; 61, 41 =&gt; 20, 68 =&gt; 25, 1297 =&gt; 209, 1285 =&gt; 204, 82 =&gt; 32, 130 =&gt; 37, 1361 =&gt; 230, 517 =&gt; 94, 1088 =&gt; 166, 66 =&gt; 24, 521 =&gt; 96, 1109 =&gt; 178, 336 =&gt; 85, 1280 =&gt; 200, 1058 =&gt; 160, 1105 =&gt; 175, 656 =&gt; 132, 1301 =&gt; 212, 2570 =&gt; 293, 2336 =&gt; 276, 578 =&gt; 113, 2644 =&gt; 309, 644 =&gt; 127, 138 =&gt; 42, 528 =&gt; 98, 1320 =&gt; 218, 276 =&gt; 67, 170 =&gt; 55, 129 =&gt; 36, 1154 =&gt; 181, 133 =&gt; 39, 1185 =&gt; 193, 72 =&gt; 27, 258 =&gt; 58, 532 =&gt; 101, 2052 =&gt; 236, 2218 =&gt; 267, 1 =&gt; 2, 137 =&gt; 41, 2176 =&gt; 255, 529 =&gt; 99, 2560 =&gt; 289, 288 =&gt; 69, 2114 =&gt; 248, 2578 =&gt; 295, 33 =&gt; 15, 1284 =&gt; 203, 677 =&gt; 141, 516 =&gt; 93, 1044 =&gt; 156, 1066 =&gt; 165, 40 =&gt; 19, 522 =&gt; 97, 1029 =&gt; 149, 1034 =&gt; 152, 1061 =&gt; 162, 165 =&gt; 52, 2212 =&gt; 265, 2372 =&gt; 283, 5 =&gt; 5, 2180 =&gt; 257, 265 =&gt; 62, 2708 =&gt; 317, 325 =&gt; 81, 2120 =&gt; 250, 660 =&gt; 135, 136 =&gt; 40, 1024 =&gt; 145, 145 =&gt; 44, 672 =&gt; 137, 1026 =&gt; 147, 1312 =&gt; 213, 337 =&gt; 86, 2602 =&gt; 301, 530 =&gt; 100, 1300 =&gt; 211, 1042 =&gt; 155, 1192 =&gt; 197, 1352 =&gt; 226, 674 =&gt; 139, 1097 =&gt; 172, 1317 =&gt; 217, 1056 =&gt; 158, 1156 =&gt; 182, 2640 =&gt; 307, 148 =&gt; 46, 1170 =&gt; 189, 36 =&gt; 17, 2304 =&gt; 268, 2724 =&gt; 320, 1345 =&gt; 222, 1321 =&gt; 219, 553 =&gt; 109, 1290 =&gt; 207, 162 =&gt; 50, 84 =&gt; 33, 1189 =&gt; 196, 1045 =&gt; 157, 292 =&gt; 72, 296 =&gt; 74, 680 =&gt; 142, 18 =&gt; 11, 1157 =&gt; 183, 2626 =&gt; 303, 16 =&gt; 9, 514 =&gt; 92, 341 =&gt; 89, 1282 =&gt; 202, 2082 =&gt; 243, 1173 =&gt; 191, 266 =&gt; 63, 146 =&gt; 45, 2376 =&gt; 284, 74 =&gt; 29, 513 =&gt; 91, 1089 =&gt; 167, 2192 =&gt; 260, 576 =&gt; 111, 580 =&gt; 114, 2568 =&gt; 292, 1160 =&gt; 184, 2720 =&gt; 318, 2690 =&gt; 311, 1354 =&gt; 228, 17 =&gt; 10, 2122 =&gt; 251, 577 =&gt; 112, 585 =&gt; 117, 520 =&gt; 95, 80 =&gt; 30, 1313 =&gt; 214, 2058 =&gt; 238, 274 =&gt; 66, 2370 =&gt; 282, 1362 =&gt; 231, 2210 =&gt; 264, 330 =&gt; 84, 552 =&gt; 108, 2344 =&gt; 279, 1184 =&gt; 192, 1194 =&gt; 199, 2564 =&gt; 291, 648 =&gt; 129, 650 =&gt; 131, 1106 =&gt; 176, 2692 =&gt; 312, 1344 =&gt; 221, 2208 =&gt; 263, 272 =&gt; 64, 1161 =&gt; 185, 164 =&gt; 51, 2600 =&gt; 300, 64 =&gt; 22, 1364 =&gt; 232, 2048 =&gt; 234, 2624 =&gt; 302, 4 =&gt; 4, 2596 =&gt; 299, 640 =&gt; 124, 1057 =&gt; 159, 658 =&gt; 134, 2184 =&gt; 258, 2728 =&gt; 321, 328 =&gt; 82, 2704 =&gt; 315, 2128 =&gt; 252, 69 =&gt; 26, 2384 =&gt; 286, 2066 =&gt; 240, 85 =&gt; 34, 2196 =&gt; 262, 2698 =&gt; 314, 2388 =&gt; 288, 2 =&gt; 3, 10 =&gt; 8, 533 =&gt; 102, 261 =&gt; 60, 2068 =&gt; 241, 1322 =&gt; 220, 144 =&gt; 43, 273 =&gt; 65, 257 =&gt; 57, 2634 =&gt; 306, 290 =&gt; 71, 20 =&gt; 12, 81 =&gt; 31, 1186 =&gt; 194, 2576 =&gt; 294, 340 =&gt; 88, 0 =&gt; 1, 329 =&gt; 83, 2306 =&gt; 269, 1289 =&gt; 206, 9 =&gt; 7, 512 =&gt; 90, 2112 =&gt; 247, 161 =&gt; 49, 1298 =&gt; 210, 2056 =&gt; 237, 1152 =&gt; 179, 2116 =&gt; 249, 645 =&gt; 128, 649 =&gt; 130, 260 =&gt; 59, 297 =&gt; 75, 545 =&gt; 104, 1098 =&gt; 173, 8 =&gt; 6, 37 =&gt; 18, 1348 =&gt; 224, 2090 =&gt; 246, 1096 =&gt; 171, 2378 =&gt; 285, 2706 =&gt; 316, 1153 =&gt; 180, 593 =&gt; 120, 1360 =&gt; 229, 554 =&gt; 110, 548 =&gt; 106, 2314 =&gt; 272, 1353 =&gt; 227, 1346 =&gt; 223, 2178 =&gt; 256, 322 =&gt; 79, 592 =&gt; 119, 597 =&gt; 123, 1104 =&gt; 174, 2308 =&gt; 270, 586 =&gt; 118, 2628 =&gt; 304, 2696 =&gt; 313, 32 =&gt; 14, 2088 =&gt; 245, 2080 =&gt; 242, 320 =&gt; 77, 681 =&gt; 143, 2346 =&gt; 280, 324 =&gt; 80, 1064 =&gt; 163, 1025 =&gt; 146, 1169 =&gt; 188, 2386 =&gt; 287, 2216 =&gt; 266, 2340 =&gt; 278, 1349 =&gt; 225, 661 =&gt; 136, 682 =&gt; 144, 1288 =&gt; 205, 256 =&gt; 56, 596 =&gt; 122, 277 =&gt; 68, 1060 =&gt; 161, 2064 =&gt; 239, 549 =&gt; 107, 2320 =&gt; 273, 1162 =&gt; 186, 321 =&gt; 78, 34 =&gt; 16, 1316 =&gt; 216, 42 =&gt; 21, 2730 =&gt; 322, 132 =&gt; 38, 2642 =&gt; 308, 169 =&gt; 54, 2338 =&gt; 277, 2580 =&gt; 296, 1040 =&gt; 153, 160 =&gt; 48, 1281 =&gt; 201, 289 =&gt; 70, 2562 =&gt; 290, 1032 =&gt; 150, 128 =&gt; 35, 21 =&gt; 13, 581 =&gt; 115, 1365 =&gt; 233, 1172 =&gt; 190, 1108 =&gt; 177, 2130 =&gt; 253, 2186 =&gt; 259, 2368 =&gt; 281, 2194 =&gt; 261, 1065 =&gt; 164, 546 =&gt; 105, 338 =&gt; 87, 2322 =&gt; 274, 2084 =&gt; 244, 1093 =&gt; 170, 149 =&gt; 47, 641 =&gt; 125, 594 =&gt; 121, 1314 =&gt; 215, 65 =&gt; 23, 293 =&gt; 73, 298 =&gt; 76, 642 =&gt; 126, 1041 =&gt; 154), [0, 1, 2, 4, 5, 8, 9, 10, 16, 17, 18, 20, 21, 32, 33, 34, 36, 37, 40, 41, 42, 64, 65, 66, 68, 69, 72, 73, 74, 80, 81, 82, 84, 85, 128, 129, 130, 132, 133, 136, 137, 138, 144, 145, 146, 148, 149, 160, 161, 162, 164, 165, 168, 169, 170, 256, 257, 258, 260, 261, 264, 265, 266, 272, 273, 274, 276, 277, 288, 289, 290, 292, 293, 296, 297, 298, 320, 321, 322, 324, 325, 328, 329, 330, 336, 337, 338, 340, 341, 512, 513, 514, 516, 517, 520, 521, 522, 528, 529, 530, 532, 533, 544, 545, 546, 548, 549, 552, 553, 554, 576, 577, 578, 580, 581, 584, 585, 586, 592, 593, 594, 596, 597, 640, 641, 642, 644, 645, 648, 649, 650, 656, 657, 658, 660, 661, 672, 673, 674, 676, 677, 680, 681, 682, 1024, 1025, 1026, 1028, 1029, 1032, 1033, 1034, 1040, 1041, 1042, 1044, 1045, 1056, 1057, 1058, 1060, 1061, 1064, 1065, 1066, 1088, 1089, 1090, 1092, 1093, 1096, 1097, 1098, 1104, 1105, 1106, 1108, 1109, 1152, 1153, 1154, 1156, 1157, 1160, 1161, 1162, 1168, 1169, 1170, 1172, 1173, 1184, 1185, 1186, 1188, 1189, 1192, 1193, 1194, 1280, 1281, 1282, 1284, 1285, 1288, 1289, 1290, 1296, 1297, 1298, 1300, 1301, 1312, 1313, 1314, 1316, 1317, 1320, 1321, 1322, 1344, 1345, 1346, 1348, 1349, 1352, 1353, 1354, 1360, 1361, 1362, 1364, 1365, 2048, 2050, 2052, 2056, 2058, 2064, 2066, 2068, 2080, 2082, 2084, 2088, 2090, 2112, 2114, 2116, 2120, 2122, 2128, 2130, 2132, 2176, 2178, 2180, 2184, 2186, 2192, 2194, 2196, 2208, 2210, 2212, 2216, 2218, 2304, 2306, 2308, 2312, 2314, 2320, 2322, 2324, 2336, 2338, 2340, 2344, 2346, 2368, 2370, 2372, 2376, 2378, 2384, 2386, 2388, 2560, 2562, 2564, 2568, 2570, 2576, 2578, 2580, 2592, 2594, 2596, 2600, 2602, 2624, 2626, 2628, 2632, 2634, 2640, 2642, 2644, 2688, 2690, 2692, 2696, 2698, 2704, 2706, 2708, 2720, 2722, 2724, 2728, 2730]))</code></pre><p>Define the time steps</p><pre><code class="language-julia hljs">Tmax = 10.
nsteps = 5001
times = LinRange(0,Tmax,nsteps)</code></pre><pre><code class="nohighlight hljs">5001-element LinRange{Float64, Int64}:
 0.0,0.002,0.004,0.006,0.008,0.01,0.012,…,9.99,9.992,9.994,9.996,9.998,10.0</code></pre><p>Time evolve the system in the full space</p><pre><code class="language-julia hljs">prob = SchrodingerProblem(init_state, Tmax, h, dt = Tmax/(nsteps-1) , adaptive = false);
integrator = init(prob, Vern6());

densities = []
for _ in TimeChoiceIterator(integrator, 0.0:Tmax/(nsteps-1):Tmax)
    push!(densities, expect(put(nsites, 1=&gt;Op.n), init_state))
end</code></pre><p>Time evolve the system in the subspace</p><pre><code class="language-julia hljs">prob2 = SchrodingerProblem(init_state2, Tmax, h, dt = Tmax/(nsteps-1) , adaptive = false);
integrator2 = init(prob2, Vern8());

densities2 = []
for _ in TimeChoiceIterator(integrator2, 0.0:Tmax/(nsteps-1):Tmax)
    push!(densities2, expect(put(nsites, 1=&gt;Op.n), init_state2))#, SubspaceArrayReg(u, space)))
end</code></pre><p>Plot the data</p><pre><code class="language-julia hljs">fig, ax = plt.subplots(figsize=(8,6))

ax.plot(times,real(densities),&quot;k&quot;,label=&quot;Full space&quot;)
ax.plot(times,real(densities2),&quot;r--&quot;,label=&quot;Subspace&quot;)
ax.axis([0,Tmax,0,0.45])
ax.set_xlabel(&quot;Time (us)&quot;)
ax.set_ylabel(&quot;Rydberg density&quot;)
plt.tight_layout()
ax.legend()

inset_axes = pyimport(&quot;mpl_toolkits.axes_grid1.inset_locator&quot;)
ax2 = inset_axes.inset_axes(ax,width=&quot;20%&quot;,height=&quot;30%&quot;,loc=&quot;lower right&quot;,borderpad=1)
ax2.plot(times,real(densities - densities2))
ax2.axis([0,0.6,-0.0008,0.0008])
ax2.set_ylabel(&quot;Difference&quot;,fontsize=12)
ax2.set_yticks(LinRange(-0.0008,0.0008,5),fontsize=12)
ax2.set_xticks([0,0.2,0.4,0.6],fontsize=12)
fig</code></pre><p><img src="../4173077227.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../quantum-scar/main/">« Quantum Scar</a><a class="docs-footer-nextpage" href="../../../topics/blockade/">Rydberg Blockade »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 15 April 2022 04:53">Friday 15 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
