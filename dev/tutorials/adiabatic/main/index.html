<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adiabatic Evolution · Bloqade.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://Happy-Diode.github.io/Bloqade.jl/tutorials/adiabatic/main/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Bloqade.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../install/">Installation</a></li><li><a class="tocitem" href="../../../julia/">The Julia Programming Language</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../waveform/">Waveforms</a></li><li><a class="tocitem" href="../../../lattices/">Lattices</a></li><li><a class="tocitem" href="../../../hamiltonians/">Hamiltonians</a></li><li><a class="tocitem" href="../../../registers/">Registers</a></li><li><a class="tocitem" href="../../../emulation/">Emulation</a></li><li><a class="tocitem" href="../../../subspace/">Working with Subspace</a></li><li><a class="tocitem" href="../../../observables/">Observables</a></li><li><a class="tocitem" href="../../../mis/">Maximum Independent Set</a></li><li><a class="tocitem" href="../../../cuda/">CUDA Acceleration</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Adiabatic Evolution</a><ul class="internal"><li><a class="tocitem" href="#Background"><span>Background</span></a></li><li class="toplevel"><a class="tocitem" href="#Ground-state-properties"><span>Ground state properties</span></a></li><li class="toplevel"><a class="tocitem" href="#Ordered-state-prepration-in-1D"><span>Ordered state prepration in 1D</span></a></li><li class="toplevel"><a class="tocitem" href="#Run-in-the-blockade-subspace"><span>Run in the blockade subspace</span></a></li><li class="toplevel"><a class="tocitem" href="#State-preparation-in-2D"><span>State preparation in 2D</span></a></li></ul></li><li><a class="tocitem" href="../../noise/main/">Adiabatic Preparation with Sensitivity Analysis</a></li><li><a class="tocitem" href="../../quantum-scar/main/">Quantum Scar</a></li><li><a class="tocitem" href="../../ring/main/">Ring Emulation</a></li></ul></li><li><span class="tocitem">Advanced Topics</span><ul><li><a class="tocitem" href="../../../topics/blockade/">Rydberg Blockade</a></li><li><a class="tocitem" href="../../../topics/bravais/">Bravais Lattice</a></li><li><a class="tocitem" href="../../../topics/ad/">Automatic Differentiation</a></li></ul></li><li><a class="tocitem" href="../../../contrib/">Contributing Bloqade</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Adiabatic Evolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Adiabatic Evolution</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Happy-Diode/Bloqade.jl/blob/master/examples/adiabatic/main.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Adiabatic-Evolution"><a class="docs-heading-anchor" href="#Adiabatic-Evolution">Adiabatic Evolution</a><a id="Adiabatic-Evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Adiabatic-Evolution" title="Permalink"></a></h1><h2 id="Background"><a class="docs-heading-anchor" href="#Background">Background</a><a id="Background-1"></a><a class="docs-heading-anchor-permalink" href="#Background" title="Permalink"></a></h2><p>In this example, we will show how to use the Emulator to prepare ordered ground states in Rydberg systems. The example is based on experimental works in a <a href="https://www.nature.com/articles/nature24622">1D system</a>, and <a href="https://www.nature.com/articles/s41586-021-03582-4">2D system</a>.</p><p>Due to the strong Rydberg interactions, only one Rydberg excitation is allowed within the blockade radius <a href="tutorials/adiabatic/@ref">Blockade</a>. With positive detunings, more Rydberg excitations are favored (to lower the ground state(s) energy). With the interplay of these two mechanisms, different ordered states are supported depending on the strength of blockade radius and the detuning, such as the <a href="https://www.nature.com/articles/nature24622"><span>$Z_N$</span> ordered states</a> (1D) and the checkboard phase, star phase, and pure quantum phase (<a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.124.103601">straited phase</a>) (2D).</p><p>We can use Quantum Adiabatic Algorithm (QAA) to prepare these quantum many-body ground states. In this process, we start with all atoms in the ground state <span>$| 0 \rangle$</span> (the ground states of the many-body Hamiltonian with large negative detuning <span>$\Delta$</span>). Then, the Rabi frequency <span>$\Omega$</span> is turned on, and the detuning strength is ramped up from a large negative value to postive values. If this process is slow enough, the quantum state of the system stays close to the ground state of the instantaneous Hamiltonian. At the end of the process, we arrive at a target Hamiltonian, and correspondingly, the prepared state is approximately the ground state for the final Hamiltonian.</p><p>We start by importing required libraries</p><pre><code class="language-julia hljs">using Bloqade
using PythonCall
using BloqadePlots
using KrylovKit
using SparseArrays

plt = pyimport(&quot;matplotlib.pyplot&quot;)</code></pre><pre><code class="nohighlight hljs">Python module: &lt;module &#39;matplotlib.pyplot&#39; from &#39;/home/runner/work/Bloqade.jl/Bloqade.jl/examples/adiabatic/.CondaPkg/env/lib/python3.10/site-packages/matplotlib/pyplot.py&#39;&gt;</code></pre><h1 id="Ground-state-properties"><a class="docs-heading-anchor" href="#Ground-state-properties">Ground state properties</a><a id="Ground-state-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Ground-state-properties" title="Permalink"></a></h1><p>To get a sense of the quantum phase transition, we will first vary the parameters of the Hamiltonian and calculate the corresponding ground state properties. We start with a 1D chain for simplicity: we consider a chain with 9 atoms, where nearby atoms are seperated by a distance of 5.72 <span>$\mu m$</span>. We can generate the system as follows</p><pre><code class="language-julia hljs">nsites = 9
atoms = generate_sites(ChainLattice(), nsites, scale=5.72)</code></pre><?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.2"
     width="120mm" height="47.27mm" viewBox="0 0 120 47.27"
     stroke="none"
     fill="#000000"
     stroke-width="0.3"
     font-size="3.88"
>
<defs>
  <marker id="arrow" markerWidth="15" markerHeight="7" refX="5" refY="3.5" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L15,3.5 L0,7 z" stroke="context-stroke" fill="context-stroke"/>
  </marker>
</defs>
<g fill="#000000" font-size="3.88" id="img-bd71421f-1">
  <g transform="translate(23.64,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">0.0μm</text>
    </g>
  </g>
  <g transform="translate(41.82,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">11.44μm</text>
    </g>
  </g>
  <g transform="translate(60,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">22.88μm</text>
    </g>
  </g>
  <g transform="translate(78.18,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">34.32μm</text>
    </g>
  </g>
  <g transform="translate(96.36,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">45.76μm</text>
    </g>
  </g>
  <g transform="translate(11.82,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">0.0μm</text>
    </g>
  </g>
</g>
<g stroke-width="0.44" fill="#FFFFFF" stroke="#000000" id="img-bd71421f-2">
  <g transform="translate(23.64,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(32.73,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(41.82,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(50.91,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(60,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(69.09,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(78.18,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(87.27,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(96.36,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
</g>
<g fill="#000000" font-size="2.57" id="img-bd71421f-3">
  <g transform="translate(23.64,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">1</text>
    </g>
  </g>
  <g transform="translate(32.73,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">2</text>
    </g>
  </g>
  <g transform="translate(41.82,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">3</text>
    </g>
  </g>
  <g transform="translate(50.91,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4</text>
    </g>
  </g>
  <g transform="translate(60,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">5</text>
    </g>
  </g>
  <g transform="translate(69.09,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">6</text>
    </g>
  </g>
  <g transform="translate(78.18,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">7</text>
    </g>
  </g>
  <g transform="translate(87.27,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">8</text>
    </g>
  </g>
  <g transform="translate(96.36,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">9</text>
    </g>
  </g>
</g>
</svg>
<p>We fix the Rabi frequency to be <span>$Ω = 2π * 4$</span>, and study the ground state as a function of detuning <span>$Δ$</span>.</p><pre><code class="language-julia hljs">Ω = 2π * 4
Δ_step = 30
Δ = LinRange(-10*2π , 10*2π , Δ_step);</code></pre><p>We compute the Rydberg density profile for each parameter of <span>$\Delta$</span>.</p><pre><code class="language-julia hljs">density_g = zeros(Δ_step, nsites)

for ii in 1:Δ_step
    h_ii = rydberg_h(atoms; Δ=Δ[ii], Ω)
    h_m = mat(h_ii)
    vals, vecs, info = KrylovKit.eigsolve(h_m,  1, :SR)
    g_state = ArrayReg(vecs[1])

    for jj in 1:nsites
        density_g[ii, jj] = real(expect(put(nsites, jj=&gt;Op.n), g_state))
    end
end</code></pre><p>To compare, we first plot the density profile when <span>$\Delta= -10*2π$</span>,</p><pre><code class="language-julia hljs">fig, ax = plt.subplots(figsize = (10,4))
ax.bar(1:nsites, density_g[1, :])
ax.set_xticks(1:nsites)
ax.set_xlabel(&quot;Sites&quot;)
ax.set_ylabel(&quot;Rydberg density&quot;)
ax.set_title(&quot;Density Profile: 1D Chain, Δ = -10 * 2π&quot;)
fig</code></pre><p><img src="../4183784888.svg" alt/></p><p>We can see that the Rydberg densities in this case is close to 0 for all sites. In contrast, for <span>$\Delta= 10*2π$</span>, the density shows a clear <span>$Z_2$</span> ordered profile</p><pre><code class="language-julia hljs">fig, ax = plt.subplots(figsize = (10,4))
ax.bar(1:nsites, density_g[20, :])
ax.set_xticks(1:nsites)
ax.set_xlabel(&quot;Sites&quot;)
ax.set_ylabel(&quot;Rydberg density&quot;)
ax.set_title(&quot;Density Profile: 1D Chain, Δ = 10 * 2π&quot;)
fig</code></pre><p><img src="../433492114.svg" alt/></p><p>More generally, we can plot an order parameter as a function of <span>$\Delta$</span> to clearly see the onset of phase transition. We can define the parameter by the difference of Rydberg densities in even and odd sites.</p><pre><code class="language-julia hljs">order_para = map(1: Δ_step) do ii
    sum(density_g[ii, 1:2:8]) - sum(density_g[ii, 2:2:8])
end

fig, ax = plt.subplots(figsize = (10,4))
ax.plot(collect(Δ)/2π, order_para)
ax.set_xlabel(&quot;Δ/2π (MHz) &quot;)
ax.set_ylabel(&quot;Order parameter&quot;)
fig</code></pre><p><img src="../292469924.svg" alt/></p><p>From the density profile of ground states and the change in order parameter, we observe a phase transition with the change in <span>$\Delta$</span>. Below, we show that by slowly changing the parameters in the Hamiltonian, we can follow the trajectory of the ground states and adibatically evolve the atoms from the ground state to the <span>$Z_2$</span> ordered state.</p><h1 id="Ordered-state-prepration-in-1D"><a class="docs-heading-anchor" href="#Ordered-state-prepration-in-1D">Ordered state prepration in 1D</a><a id="Ordered-state-prepration-in-1D-1"></a><a class="docs-heading-anchor-permalink" href="#Ordered-state-prepration-in-1D" title="Permalink"></a></h1><p>We first specify the adiabatic pulse sequence for Rabi frequency by using the built-in waveform function <a href="../../../waveform/#BloqadeWaveforms.piecewise_linear"><code>piecewise_linear</code></a></p><pre><code class="language-julia hljs">total_time = 3.0;
Ω_max = 2π * 4;
Ω = piecewise_linear(clocks=[0.0, 0.1, 2.1, 2.2, total_time], values=[0.0, Ω_max, Ω_max, 0, 0]);</code></pre><p>The detuning sequence could also be created in a similar way</p><pre><code class="language-julia hljs">U1 = -2π * 10;
U2 = 2π * 10;
Δ = piecewise_linear(clocks=[0.0, 0.6, 2.1, total_time], values=[U1, U1, U2, U2]);</code></pre><p>We plot the two waveforms:</p><pre><code class="language-julia hljs">fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(10, 4))
draw!(ax1, Ω)
draw!(ax2, Δ)
fig</code></pre><p><img src="../1555041795.svg" alt/></p><p>We then generate the positions of a 1D atomic chain by using the function <a href="../../../lattices/#BloqadeLattices.generate_sites-Union{Tuple{D}, Tuple{AbstractLattice{D}, Vararg{Int64, D}}} where D"><code>generate_sites</code></a></p><pre><code class="language-julia hljs">nsites = 9
atoms = generate_sites(ChainLattice(), nsites, scale=5.72)</code></pre><?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.2"
     width="120mm" height="47.27mm" viewBox="0 0 120 47.27"
     stroke="none"
     fill="#000000"
     stroke-width="0.3"
     font-size="3.88"
>
<defs>
  <marker id="arrow" markerWidth="15" markerHeight="7" refX="5" refY="3.5" orient="auto" markerUnits="strokeWidth">
    <path d="M0,0 L15,3.5 L0,7 z" stroke="context-stroke" fill="context-stroke"/>
  </marker>
</defs>
<g fill="#000000" font-size="3.88" id="img-2764d7c8-1">
  <g transform="translate(23.64,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">0.0μm</text>
    </g>
  </g>
  <g transform="translate(41.82,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">11.44μm</text>
    </g>
  </g>
  <g transform="translate(60,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">22.88μm</text>
    </g>
  </g>
  <g transform="translate(78.18,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">34.32μm</text>
    </g>
  </g>
  <g transform="translate(96.36,33.09)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">45.76μm</text>
    </g>
  </g>
  <g transform="translate(11.82,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">0.0μm</text>
    </g>
  </g>
</g>
<g stroke-width="0.44" fill="#FFFFFF" stroke="#000000" id="img-2764d7c8-2">
  <g transform="translate(23.64,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(32.73,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(41.82,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(50.91,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(60,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(69.09,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(78.18,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(87.27,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
  <g transform="translate(96.36,23.64)">
    <circle cx="0" cy="0" r="2.18" class="primitive"/>
  </g>
</g>
<g fill="#000000" font-size="2.57" id="img-2764d7c8-3">
  <g transform="translate(23.64,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">1</text>
    </g>
  </g>
  <g transform="translate(32.73,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">2</text>
    </g>
  </g>
  <g transform="translate(41.82,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">3</text>
    </g>
  </g>
  <g transform="translate(50.91,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">4</text>
    </g>
  </g>
  <g transform="translate(60,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">5</text>
    </g>
  </g>
  <g transform="translate(69.09,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">6</text>
    </g>
  </g>
  <g transform="translate(78.18,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">7</text>
    </g>
  </g>
  <g transform="translate(87.27,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">8</text>
    </g>
  </g>
  <g transform="translate(96.36,23.64)">
    <g class="primitive">
      <text text-anchor="middle" dy="0.35em">9</text>
    </g>
  </g>
</g>
</svg>
<p>Note that we have specified the nearest-neighbor atoms to be seperated by 5.72 <span>$\mu m$</span> in order to prepare a <span>$Z_2$</span> ordered state. With the waveforms and atomic coordinates specified, the time-dependent Hamiltonian can be simply generated by</p><pre><code class="language-julia hljs">h = rydberg_h(atoms; Δ, Ω)</code></pre><pre><code class="nohighlight hljs">nqubits: 9
+
├─ [+] ∑ 5.42e6/|r_i-r_j|^6 n_i n_j
├─ [+] Ω(t) ⋅ ∑ σ^x_i
└─ [-] Δ(t) ⋅ ∑ n_i
</code></pre><p>We then specify all atoms to be in ground state initially, and set up the emulation problem by choosing the ODE solver</p><pre><code class="language-julia hljs">reg = zero_state(9);
prob = SchrodingerProblem(reg, total_time, h);
integrator = init(prob, Vern8());</code></pre><p>We measure the Rydberg density for each site and time step</p><pre><code class="language-julia hljs">densities = []
for _ in TimeChoiceIterator(integrator, 0.0:1e-3:total_time)
    push!(densities, [expect(put(nsites, i=&gt;Op.n), reg) for i in 1:nsites])
end
D = hcat(densities...);</code></pre><p>Finally, we plot the time-dependent dynamics of Rydberg density for each site</p><pre><code class="language-julia hljs">clocks = [t for t in 0:1e-3:total_time]
fig, ax = plt.subplots(figsize = (10,4))
ax.imshow(real(D), interpolation=&quot;nearest&quot;, aspect=&quot;auto&quot;)
ax.set_xlabel(&quot;iterations&quot;)
ax.set_ylabel(&quot;rydberg density per site&quot;)
fig</code></pre><p><img src="../1007000656.svg" alt/></p><p>We can clearly see that a <span>$Z_2$</span> ordered state has been generated by the specified adiabatic pulse sequence. We can also confirm this by plotting out the bitstring distribution at the final time step</p><pre><code class="language-julia hljs">bitstring_hist(reg; nlargest=20)</code></pre><p><img src="../4235894640.svg" alt/></p><p>To prepare <span>$Z_3$</span> (<span>$Z_4$</span>) states, we can reduce the seperation between nearby atoms to 3.57 <span>$\mu m$</span> (2.87 <span>$\mu m$</span>).</p><h1 id="Run-in-the-blockade-subspace"><a class="docs-heading-anchor" href="#Run-in-the-blockade-subspace">Run in the blockade subspace</a><a id="Run-in-the-blockade-subspace-1"></a><a class="docs-heading-anchor-permalink" href="#Run-in-the-blockade-subspace" title="Permalink"></a></h1><p>In the above example, we have run the emulation in fullspace, which can be slow and only works for small system. We can turn the above simulation into a blockade subspace simulation by changing the register to a <code>SubspaceArrayReg</code> by feeding a subspace object.</p><p>The subspace can be found by looking up the independent set of the graph constructed by a blockade radius; here we choose the radius to be 6.2 <span>$\mu m$</span></p><pre><code class="language-julia hljs">space = blockade_subspace(atoms, 6.2);</code></pre><p>Then we create our register in subspace</p><pre><code class="language-julia hljs">reg = zero_state(space)</code></pre><pre><code class="nohighlight hljs">YaoSubspaceArrayReg.SubspaceArrayReg{Vector{ComplexF64}, BloqadeExpr.Subspace{Vector{Int64}}}(9, ComplexF64[1.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im, 0.0 + 0.0im], BloqadeExpr.Subspace{Vector{Int64}}(9, Dict(5 =&gt; 5, 265 =&gt; 62, 325 =&gt; 81, 32 =&gt; 14, 136 =&gt; 40, 145 =&gt; 44, 73 =&gt; 28, 272 =&gt; 64, 164 =&gt; 51, 320 =&gt; 77, 337 =&gt; 86, 64 =&gt; 22, 324 =&gt; 80, 4 =&gt; 4, 168 =&gt; 53, 328 =&gt; 82, 148 =&gt; 46, 256 =&gt; 56, 277 =&gt; 68, 264 =&gt; 61, 41 =&gt; 20, 69 =&gt; 26, 36 =&gt; 17, 68 =&gt; 25, 82 =&gt; 32, 85 =&gt; 34, 130 =&gt; 37, 162 =&gt; 50, 84 =&gt; 33, 321 =&gt; 78, 66 =&gt; 24, 292 =&gt; 72, 34 =&gt; 16, 2 =&gt; 3, 10 =&gt; 8, 18 =&gt; 11, 261 =&gt; 60, 296 =&gt; 74, 336 =&gt; 85, 42 =&gt; 21, 144 =&gt; 43, 132 =&gt; 38, 273 =&gt; 65, 257 =&gt; 57, 169 =&gt; 54, 16 =&gt; 9, 20 =&gt; 12, 81 =&gt; 31, 290 =&gt; 71, 341 =&gt; 89, 160 =&gt; 48, 340 =&gt; 88, 0 =&gt; 1, 289 =&gt; 70, 329 =&gt; 83, 266 =&gt; 63, 9 =&gt; 7, 146 =&gt; 45, 74 =&gt; 29, 138 =&gt; 42, 161 =&gt; 49, 276 =&gt; 67, 128 =&gt; 35, 21 =&gt; 13, 170 =&gt; 55, 129 =&gt; 36, 260 =&gt; 59, 297 =&gt; 75, 133 =&gt; 39, 72 =&gt; 27, 258 =&gt; 58, 8 =&gt; 6, 17 =&gt; 10, 37 =&gt; 18, 1 =&gt; 2, 137 =&gt; 41, 338 =&gt; 87, 288 =&gt; 69, 80 =&gt; 30, 33 =&gt; 15, 274 =&gt; 66, 149 =&gt; 47, 40 =&gt; 19, 65 =&gt; 23, 330 =&gt; 84, 293 =&gt; 73, 165 =&gt; 52, 298 =&gt; 76, 322 =&gt; 79), [0, 1, 2, 4, 5, 8, 9, 10, 16, 17, 18, 20, 21, 32, 33, 34, 36, 37, 40, 41, 42, 64, 65, 66, 68, 69, 72, 73, 74, 80, 81, 82, 84, 85, 128, 129, 130, 132, 133, 136, 137, 138, 144, 145, 146, 148, 149, 160, 161, 162, 164, 165, 168, 169, 170, 256, 257, 258, 260, 261, 264, 265, 266, 272, 273, 274, 276, 277, 288, 289, 290, 292, 293, 296, 297, 298, 320, 321, 322, 324, 325, 328, 329, 330, 336, 337, 338, 340, 341]))</code></pre><p>The rest of code will be the same as the full space</p><pre><code class="language-julia hljs">prob = SchrodingerProblem(reg, total_time, h)
emulate!(prob)
bitstring_hist(prob.reg; nlargest=20)</code></pre><p><img src="../1895613360.svg" alt/></p><h1 id="State-preparation-in-2D"><a class="docs-heading-anchor" href="#State-preparation-in-2D">State preparation in 2D</a><a id="State-preparation-in-2D-1"></a><a class="docs-heading-anchor-permalink" href="#State-preparation-in-2D" title="Permalink"></a></h1><p>Now we will show how to prepare a 2D checkboard phase. Most of codes will be the same as the 1D case, except that we will choose slightly different parameters and specify a square lattice instead of a chain</p><pre><code class="language-julia hljs">nx, ny = 3, 3
nsites = nx*ny
atoms = generate_sites(SquareLattice(), nx, ny, scale=6.7)

total_time = 2.9
Ω_max = 2π * 4.3
Ω = piecewise_linear(clocks=[0.0, 0.3, 2.6, total_time], values=[0.0, Ω_max , Ω_max , 0]);

U = 2π * 15.0
Δ = piecewise_linear(clocks=[0.0, 0.3, 2.6, total_time], values=[-U, -U, U , U]);

fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(10, 4))
draw!(ax1, Ω)
draw!(ax2, Δ)
fig

h = rydberg_h(atoms; Δ, Ω)


reg = zero_state(9)
prob = SchrodingerProblem(reg, total_time, h)
integrator = init(prob, Vern8())
densities = [];</code></pre><p>If you are using adaptive steps (by default), you can use <code>TimeChoiceIterator</code> to specify the points you would like to stop by</p><pre><code class="language-julia hljs">for _ in TimeChoiceIterator(integrator, 0.0:1e-3:total_time)
    push!(densities, [expect(put(nsites, i=&gt;Op.n), reg) for i in 1:nsites])
end
D = hcat(densities...)

clocks = [t for t in 0:1e-3:total_time]

fig, ax = plt.subplots(figsize = (10,4))
ax.imshow(real(D), interpolation=&quot;nearest&quot;, aspect=&quot;auto&quot;)
ax.set_xlabel(&quot;iterations&quot;)
ax.set_ylabel(&quot;rydberg density per site&quot;)
fig</code></pre><p><img src="../3359163666.svg" alt/></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../cuda/">« CUDA Acceleration</a><a class="docs-footer-nextpage" href="../../noise/main/">Adiabatic Preparation with Sensitivity Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 15 April 2022 04:08">Friday 15 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
